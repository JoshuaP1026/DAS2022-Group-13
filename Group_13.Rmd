---
title: "Group 13 GLM - Ikea Dataset"
author: "Group 13"
date: "14/03/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r loadpackages, echo=FALSE, eval=TRUE, warning=FALSE, message=FALSE}
library(tidyverse)
library(moderndive)
library(gapminder)
library(sjPlot)
library(stats)
library(jtools)
library(dplyr)
library(zoo)
library(kableExtra)
library(scales)
library(gridExtra)
```

# Introduction and Cleaning the Data {#sec:intro}


The dataset contains information on IKEA furniture from Saudi Arabia, a column has been added indicating if the piece of furniture costs more than 1000 Riyals.



```{r dataset, echo=FALSE, eval=TRUE, warning=FALSE,message=FALSE}
data<- read.csv("dataset13.csv")

data<-mutate(data, thousandRiyals=ifelse(price>= 1000,"Yes", "No"))
head(data)
```

The summary of the data indicates that there is a lot of NA values in the height, depth and width columns.
 
``` {r summary, echo=FALSE, eval=TRUE, warning=FALSE, message=FALSE}
summary(data)
```

To solve this, I computed the mean of the depth, height and width by the category and replaced the NA's by this value shown below.

``` {r replace NA, echo=FALSE, eval=TRUE, warning=FALSE, message= FALSE}
cols<-c("depth","height","width")
data<-data%>%
  group_by(category)%>%
  mutate_at(cols, na.aggregate)
data
```


# Exploratory Analysis {#sec:exploratory}

This section is to explore the data set graphically and gain insight before fitting the Generalised Linear Model (GLM).

This table shows how many pieces of furniture are in each category for the data and is then shown as a barchart. It can be seen that the lowest number of furniture items is for Room dividers and the highest is for Chairs.There is a lot of variability in the number of items in each category.

```{r table1, echo=FALSE, eval=TRUE, warning=FALSE, message=FALSE}
table1<-data%>%
  group_by(category)%>%
  summarize(count=n())%>%
 kable(caption='\\label{tab:table1} Total number of items of furniture by category') %>%
kable_styling(font_size = 8, latex_options = "hold_position", full_width=FALSE)
table1

```

```{r barchart1, echo=FALSE, eval=TRUE, warning=FALSE, message=FALSE, out.width='70%',fig.align='center', fig.pos='H', fig.cap="\\label{fig:barchart1} Total Number of Items of Furniture by Category."}

barchart1<-ggplot(data=data, aes(x=category))+
  geom_bar(fill="violetred")+
  labs(x="Category", y="Count", title="Total Number of Items of Furniture by Category")+
  scale_x_discrete(labels=wrap_format(2))+
  theme(axis.text=element_text(size=5))
barchart1 
```
  
The barchart below is showing the total number in each category by if they are priced above or below 1000 Riyals.It shows that some categories have no items priced greater than 1000 Riyals.

```{r barchart2, echo=FALSE, eval=TRUE, warning=FALSE, message=FALSE, out.width='70%',fig.align='center', fig.pos='H', fig.cap="\\label{fig:barchart2} Total Number of Items of Furniture by Category and if they cost greater than 1000 Riyals."}
barchart2<-ggplot(data=data, aes(x=category, fill=thousandRiyals))+
  geom_bar(position="dodge")+
  labs(x="Category", y="Count", title="Total Number of Items of Furniture by Category and \n Price greater than 1000 Riyasl")+
  scale_x_discrete(labels=wrap_format(2))+
  theme(axis.text=element_text(size=3))+
  scale_fill_manual("Price>1000 Riyals", values=c("violetred","turquoise"))
barchart2
```
  
The below box plots explore the relationship between some categorical variables and the price of the item.Only one item is not available online so the plots including that are not very illuminating.

The first shows some potential outliers in some categories which are much more expensive than other items in that category. 

```{r boxplot1,, echo=FALSE, eval=TRUE, warning=FALSE, message=FALSE, out.width='70%',fig.align='center', fig.pos='H', fig.cap="\\label{fig:boxplot1} Price of the Item of Furniture by Category." }

boxplot1<-ggplot(data, aes(x=category, y=price))+
  geom_boxplot(fill="violetred")+
  labs(x="Category", y="Price(Riyals)", title="Price of Furniture by Category")+
  scale_x_discrete(labels=wrap_format(2))+
  theme(axis.text=element_text(size=3))
boxplot1
```

The box plot below shows whether it is available to buy in other colours and the items price.It appears that the price range for items available in other colours is slightly higher.
```{r boxplot2, echo=FALSE, eval=TRUE, warning=FALSE, message=FALSE, out.width='70%',fig.align='center', fig.pos='H', fig.cap="\\label{fig:boxplot2} Price of the Item of Furniture by Availability in other Colours." }

boxplot2<-ggplot(data, aes(x=other_colors, y=price, fill=other_colors))+
  geom_boxplot()+
  labs(x="Available in other Colours", y="Price(Riyals)", title="Price of Furniture by Availability in Different Colours")+
 scale_fill_manual("Different Colours Available", values=c("violetred","turquoise"))

boxplot2
```

The next three plots show the height, width and depth of the item of furniture and whether it costs more than 1000 Riyals. These show that the items that cost more than 1000 Riyals have bigger height, width, depth and general size.
```{r boxplot3, echo=FALSE, eval=TRUE, warning=FALSE, message=FALSE, out.width='70%',fig.align='center', fig.pos='H', fig.cap="\\label{fig:boxplot3} Height of Item by whether the Price is greater than 1000 Riyals." }

boxplot3<-ggplot(data, aes(x=thousandRiyals, y=height, fill=thousandRiyals))+
  geom_boxplot()+
  labs(x="Price greater than 1000 Riyals", y="Height", title="Height of Furniture \n by Price greater than 1000 Riyals")+
scale_fill_manual("Price>1000 Riyals", values=c("violetred","turquoise"))
 
boxplot3
```

```{r boxplot4, echo=FALSE, eval=TRUE, warning=FALSE, message=FALSE, out.width='70%',fig.align='center', fig.pos='H', fig.cap="\\label{fig:boxplot4} Width of Item by whether the Price is greater than 1000 Riyals." }

boxplot4<-ggplot(data, aes(x=thousandRiyals, y=width, fill=thousandRiyals))+
  geom_boxplot()+
  labs(x="Price greater than 1000 Riyals", y="Width", title="Width of Furniture \n by Price greater than 1000 Riyals")+
scale_fill_manual("Price>1000 Riyals", values=c("violetred","turquoise"))
 
boxplot4
```

```{r boxplot5, echo=FALSE, eval=TRUE, warning=FALSE, message=FALSE, out.width='70%',fig.align='center', fig.pos='H', fig.cap="\\label{fig:boxplot5} Depth of Item by whether the Price is greater than 1000 Riyals." }

boxplot5<-ggplot(data, aes(x=thousandRiyals, y=depth, fill=thousandRiyals))+
  geom_boxplot()+
  labs(x="Price greater than 1000 Riyals", y="Depth", title="Depth of Furniture \n by Price greater than 1000 Riyals")+
  scale_fill_manual("Price>1000 Riyals", values=c("violetred","turquoise"))

 
boxplot5
```


```{r boxplot6, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}

grid.arrange(boxplot3, boxplot4, boxplot5, ncol=2)
```
