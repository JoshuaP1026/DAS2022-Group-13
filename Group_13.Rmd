---
title: "Group 13 GLM - Ikea Dataset"
author: "Group 13"
date: "14/03/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r loadpackages, echo=FALSE, eval=TRUE, warning=FALSE, message=FALSE}
library(tidyverse)
library(moderndive)
library(gapminder)
library(sjPlot)
library(stats)
library(jtools)
library(dplyr)
library(zoo)
library(kableExtra)
library(scales)
```

# Introduction and Cleaning the Data {#sec:intro}


The dataset contains information on IKEA furniture from Saudi Arabia, a column has been added indicating if the piece of furniture costs more than 1000 Riyals.



```{r dataset, echo=FALSE, eval=TRUE, warning=FALSE,message=FALSE}
data<- read.csv("dataset13.csv")

data<-mutate(data, thousandRiyals=ifelse(price>= 1000,"Yes", "No"))
head(data)
```

The summary of the data indicates that there is a lot of NA values in the height, depth and width columns.
 
``` {r summary, echo=FALSE, eval=TRUE, warning=FALSE, message=FALSE}
summary(data)
```

To solve this, I computed the mean of the depth, height and width by the category and replaced the NA's by this value shown below.

``` {r replace NA, echo=FALSE, eval=TRUE, warning=FALSE, message= FALSE}
cols<-c("depth","height","width")
data<-data%>%
  group_by(category)%>%
  mutate_at(cols, na.aggregate)
data
```


# Exploratory Analysis {#sec:exploratory}

This section is to explore the data set graphically and gain insight before fitting the Generalised Linear Model (GLM).

This table shows how many pieces of furniture are in each category for the data and is then shown as a barchart. It can be seen that the lowest number of furniture items is for Room dividers and the highest is for Chairs.There is a lot of variability in the number of items in each category.

```{r table1, echo=FALSE, eval=TRUE, warning=FALSE, message=FALSE}
table1<-data%>%
  group_by(category)%>%
  summarize(count=n())%>%
 kable(caption='\\label{tab:table1} Total number of items of furniture by category') %>%
kable_styling(font_size = 8, latex_options = "hold_position", full_width=FALSE)
table1

```

```{r barchart1, echo=FALSE, eval=TRUE, warning=FALSE, message=FALSE, out.width='70%',fig.align='center', fig.pos='H', fig.cap="\\label{fig:barchart1} Total Number of Items of Furniture by Category."}

barchart1<-ggplot(data=data, aes(x=category))+
  geom_bar(fill="violetred")+
  labs(x="Category", y="Count", title="Total Number of Items of Furniture by Category")+
  scale_x_discrete(labels=wrap_format(2))+
  theme(axis.text=element_text(size=5))
barchart1 
```
  
The barchart below is showing the total number in each category by if they are priced above or below 1000 Riyals.It shows that some categories have no items priced greater than 1000 Riyals.

```{r barchart2, echo=FALSE, eval=TRUE, warning=FALSE, message=FALSE, out.width='70%',fig.align='center', fig.pos='H', fig.cap="\\label{fig:barchart1} Total Number of Items of Furniture by Category and if they cost greater than 1000 Riyals."}
barchart2<-ggplot(data=data, aes(x=category, fill=thousandRiyals))+
  geom_bar(position="dodge")+
  labs(x="Category", y="Count", title="Total Number of Items of Furniture by Category and \n Price greater than 1000 Riyasl")+
  scale_x_discrete(labels=wrap_format(2))+
  theme(axis.text=element_text(size=3))+
  scale_fill_manual("Price>1000 Riyals", values=c("violetred","turquoise"))
barchart2
```
  
  



